
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Context &#8212; Hub23 Deployment Guide</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Creating files" href="create-files.html" />
    <link rel="prev" title="Installation" href="install.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">Hub23 Deployment Guide</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Hub23 Deployment Guide
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../azure-prereqs/index.html">
   Azure Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../azure-prereqs/resource-group/index.html">
     Getting Started on Azure
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/resource-group/install.html">
       Installation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/resource-group/create-resource-group.html">
       Create the Resource Group
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../azure-prereqs/key-vault/index.html">
     Azure Key Vault
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/key-vault/install.html">
       Installation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/key-vault/create-key-vault.html">
       Create the Key Vault
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/key-vault/add-secrets.html">
       Adding secrets to the Key Vault
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/key-vault/download-secrets.html">
       Downloading Secrets from the Key Vault
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/key-vault/service-principals.html">
       Service Principal
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../azure-prereqs/container-registry/index.html">
     Azure Container Registry
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/container-registry/install.html">
       Installation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../azure-prereqs/container-registry/create-acr.html">
       Create an Azure Container Registry
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../deploy-k8s/index.html">
   Deploy a Kubernetes Cluster with AKS
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/download-secrets.html">
     Download the required secrets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/network-policies.html">
     Enable Network Policies
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/az-aks-create.html">
     Deploy the Kubernetes cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/upgrade.html">
     Upgrading the Kubernetes cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../deploy-k8s/refs.html">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../setup-helm/index.html">
   Setup Helm
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../setup-helm/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../setup-helm/setup-helm.html">
     Setting up Helm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Enabling HTTPS using
   <code class="docutils literal notranslate">
    <span class="pre">
     cert-manager
    </span>
   </code>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Context
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="create-files.html">
     Creating files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="deployment.html">
     Deploying
     <code class="docutils literal notranslate">
      <span class="pre">
       cert-manager
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="refs.html">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../binderhub/index.html">
   Installing BinderHub
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../binderhub/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../binderhub/installing-binderhub.html">
     Installing BinderHub directly from the Helm Chart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../binderhub/installing-binderhub-local-helm-chart.html">
     Installing BinderHub with a Local Helm Chart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../binderhub/connect-container-registry.html">
     Connect a Container Registry
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../binderhub/github-api-limit.html">
     Increasing GitHub API limit
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../customising/index.html">
   Customising your Deployment
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../customising/changing-logo.html">
     Changing the logo on the Binder page
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../customising/customise-jupyterhub.html">
     Customising User Resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../customising/refs.html">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advanced/index.html">
   Advanced Configurations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced/enabling-authentication.html">
     Enabling Authentication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced/enabling-page-redirection.html">
     Enabling Page Redirection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced/optimising-jupyterhub.html">
     Optimising the JupyterHub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advanced/refs.html">
     References
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tearing-down/index.html">
   Tearing Down BinderHub
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tearing-down/install.html">
     Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tearing-down/teardown.html">
     Tearing down your Deployment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tearing-down/refs.html">
     References
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/cert-manager/context.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-cert-manager-works">
   How
   <code class="docutils literal notranslate">
    <span class="pre">
     cert-manager
    </span>
   </code>
   works
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="context">
<span id="content-cert-manager-context"></span><h1>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h1>
<p>To setup secure HTTPS communication, we need to have a <em>certificate</em> associated with our <em>domain</em> from a <em>Certificate Authority</em> (CA).
Thankfully, there’s <a class="reference external" href="https://letsencrypt.org/">Let’s Encrypt</a> which is a widely trusted CA that is also free to request certificates from.</p>
<p>But CA’s don’t just give away certificates.
They require proof of domain ownership through a <em>challenge</em>.
This is technically cumbersone and often automated by services like <a class="reference external" href="https://github.com/jetstack/cert-manager"><code class="docutils literal notranslate"><span class="pre">cert-manager</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>HTTPS</em> is the secured version of HTTP: HyperText Transfer Protocol.
HTTP is the protocol used by browsers and web servers to communicate and exchange information.
When that exchange of data is encrypted with SSL/<em>TLS</em>, then we call it <em>HTTPS</em>.
The S stands for Secure.</p>
</div>
<p>TLS termination, the transition from encrypted to unencrypted traffic, can be done in various locations.
A common place in the world of Kubernetes is to let this be managed by ingress controllers.
An ingress controller is something that acts to make Kubernetes ingress resources come to life.
It is possible to use an ingress controller made available by your cloud provider or one that you have hosted yourself within the cluster, such as <a class="reference external" href="https://github.com/helm/charts/tree/master/stable/nginx-ingress"><code class="docutils literal notranslate"><span class="pre">nginx-ingress</span></code></a>.</p>
<p>Below is a guide on how to use <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> along with <code class="docutils literal notranslate"><span class="pre">nginx-ingress</span></code> to enable HTTPS.
Both of these can be installed as Helm Charts.</p>
<div class="section" id="how-cert-manager-works">
<h2>How <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> works<a class="headerlink" href="#how-cert-manager-works" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> looks at <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Kubernetes ingress resources</a>.
For each ingress resource it finds, it further looks for annotations attached this resource.
If the ingress resource has an annotation that indicates <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> needs to take action, then it will try to provide a certificate from Let’s Encrypt.</p>
<p>An example of an annotation indicating the resource requires a certificate and <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> should request one looks as follows:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">kubernetes.io/tls-acme</span><span class="p">:</span> <span class="s">&quot;true&quot;</span>
</pre></div>
</div>
<p>If it decides action is required, <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> will further look at the ingress object.
What hosts or domains does it want to handle traffic to?
From what Kubernetes secret resource does it want to read the certificate from?
It will combine this information with any default settings such as what <em>Issuer</em> to use.</p>
<p>An <em>Issuer</em> is a <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code> concept.
It describes what CA to speak with, what email to use as a contact person, and what kind of challenge to use.
This can be configured in <code class="docutils literal notranslate"><span class="pre">cert-manager</span></code>’s helm chart values like so:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration of cert-manager default values</span>
<span class="c1"># for requesting certificates</span>
<span class="nt">cert-manager</span><span class="p">:</span>
  <span class="nt">ingressShim</span><span class="p">:</span>
    <span class="nt">defaultIssuerName</span><span class="p">:</span> <span class="s">&quot;a-manually-created-issuer-resource&quot;</span>
    <span class="nt">defaultIssuerKind</span><span class="p">:</span> <span class="s">&quot;Issuer&quot;</span>
    <span class="nt">defaultACMEChallengeType</span><span class="p">:</span> <span class="s">&quot;http01&quot;</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./cert-manager"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="install.html" title="previous page">Installation</a>
    <a class='right-next' id="next-link" href="create-files.html" title="next page">Creating files</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sarah Gibson<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>